<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { background: #0a0a0a; color: #d1d1d1; font-family: monospace; padding: 25px; display: flex; flex-direction: column; align-items: center; }
        textarea { width: 100%; max-width: 850px; height: 280px; background: #000; color: #00ff00; border: 1px solid #222; padding: 12px; margin: 10px 0; outline: none; font-size: 13px; }
        .btns { display: flex; gap: 15px; margin: 10px 0; }
        button { background: #111; color: #fff; border: 1px solid #333; padding: 12px 25px; cursor: pointer; text-transform: uppercase; font-weight: bold; }
        button:hover { background: #1a1a1a; border-color: #00ff00; color: #00ff00; }
        #st { font-size: 11px; color: #444; margin: 5px; }
        #out { color: #00bcff; border-color: #111; }
    </style>
</head>
<body>

    <textarea id="in" placeholder="json input"></textarea>
    
    <div class="btns">
        <button id="run">run</button>
        <button id="runv2">run v2</button>
    </div>

    <div id="st">idle</div>
    <textarea id="out" readonly placeholder="lua output"></textarea>

    <script>
        const URL = "https://raw.githubusercontent.com/MaximumADHD/Roblox-Client-Tracker/refs/heads/roblox/FVariables.txt";
        const btn1 = document.getElementById('run');
        const btn2 = document.getElementById('runv2');
        const st = document.getElementById('st');
        const reg = /^(DFFlag|DFInt|DFString|FFlag|FInt|FString)/;

        async function getValidFlags() {
            st.innerText = "syncing...";
            try {
                const res = await fetch(URL);
                const txt = await res.text();
                return new Set(txt.split('\n').map(l => l.replace("[C++] ", "").trim()));
            } catch (e) {
                st.innerText = "sync_error";
                return null;
            }
        }

        async function process(mode) {
            const raw = document.getElementById('in').value;
            if (!raw) return;
            
            const valid = await getValidFlags();
            if (!valid) return;

            try {
                const data = JSON.parse(raw);
                let res = "";

                if (mode === 1) {
                    for (let k in data) {
                        if (valid.has(k)) {
                            let ck = k.replace(reg, "");
                            res += `pcall(function() setfflag("${ck}", "${data[k]}") end)\n`;
                        }
                    }
                } else {
                    res = "local f = {\n";
                    for (let k in data) {
                        if (valid.has(k)) {
                            let ck = k.replace(reg, "");
                            res += `    ["${ck}"] = "${data[k]}",\n`;
                        }
                    }
                    res += "}\n\nfor k, v in pairs(f) do\n    pcall(function() setfflag(k, v) end)\nend";
                }

                document.getElementById('out').value = res;
                st.innerText = "success";
            } catch (e) {
                st.innerText = "json_error";
            }
        }

        btn1.addEventListener('click', () => process(1));
        btn2.addEventListener('click', () => process(2));
    </script>
</body>
</html>
